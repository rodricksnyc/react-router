{"version":3,"file":"FilterCollection.spec.js","names":["jest","mock","requireActual","model_fieldname_suggestions","fn","sdk","get","describe","it","onChangeMock","sdkOkMock","value","Promise","resolve","sdkGetMock","suggestions","sdkMock","ok","renderWithTheme","dimension","name","title","field","project_name","suggest_dimension","view","model","ui_config","type","listens_to_filters","suggestable","fireEvent","click","screen","getByText","findByText","expect","toHaveBeenCalledTimes","toHaveBeenLastCalledWith","field_name","filters","model_name","term","view_name"],"sources":["../../../src/FilterCollection/FilterCollection.spec.tsx"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nimport React from 'react'\nimport { renderWithTheme } from '@looker/components-test-utils'\nimport type { IAPIMethods } from '@looker/sdk-rtl'\nimport { fireEvent, screen } from '@testing-library/react'\nimport { FilterCollection } from './FilterCollection'\nimport { DashboardFilter } from '../DashboardFilter'\n\njest.mock('@looker/sdk', () => ({\n  ...jest.requireActual('@looker/sdk'),\n  model_fieldname_suggestions: jest.fn((sdk: { get: () => any }) => sdk.get()),\n}))\n\n// eslint-disable-next-line import/first\nimport { model_fieldname_suggestions } from '@looker/sdk'\n\ndescribe('FilterCollection', () => {\n  it('shares state for linked filters', async () => {\n    const onChangeMock = jest.fn()\n    const sdkOkMock = jest.fn(value => Promise.resolve(value))\n\n    const sdkGetMock = jest.fn(() => ({\n      suggestions: ['brand1', 'brand2', 'brand3'],\n    }))\n\n    const sdkMock = {\n      ok: sdkOkMock,\n      get: sdkGetMock,\n    } as unknown as IAPIMethods\n\n    renderWithTheme(\n      <FilterCollection sdk={sdkMock}>\n        <DashboardFilter\n          filter={{\n            dimension: 'products.category',\n            name: 'Category',\n            title: 'Category',\n            field: {\n              name: 'products.category',\n              suggestions: ['Accessories', 'Home + Garden'],\n              project_name: 'testmodel_',\n              suggest_dimension: 'products.category',\n              view: 'products',\n            },\n            model: 'testmodel',\n            ui_config: { type: 'button_group' },\n          }}\n          onChange={onChangeMock}\n        />\n        <DashboardFilter\n          filter={{\n            name: 'Brand',\n            title: 'Brand',\n            listens_to_filters: ['Category'],\n            field: {\n              name: 'products.brand',\n              suggestable: true,\n              project_name: 'testmodel_',\n              suggest_dimension: 'products.brand',\n              view: 'products',\n            },\n            model: 'testmodel',\n            ui_config: { type: 'button_group' },\n          }}\n          onChange={onChangeMock}\n        />\n      </FilterCollection>\n    )\n\n    fireEvent.click(screen.getByText('Home + Garden'))\n\n    await screen.findByText('brand1')\n\n    expect(model_fieldname_suggestions).toHaveBeenCalledTimes(2)\n    expect(model_fieldname_suggestions).toHaveBeenLastCalledWith(\n      { ok: sdkOkMock, get: sdkGetMock },\n      {\n        field_name: 'products.brand',\n        filters: {\n          'products.category': 'Home%20%2B%20Garden',\n        },\n        model_name: 'testmodel',\n        term: '',\n        view_name: 'products',\n      }\n    )\n  })\n})\n"],"mappings":";;;;;AAKA;AACA;AAEA;AACA;AACA;AAQA;AAAyD;AAAA;AANzDA,IAAI,CAACC,IAAI,CAAC,aAAa,EAAE;EAAA,uCACpBD,IAAI,CAACE,aAAa,CAAC,aAAa,CAAC;IACpCC,2BAA2B,EAAEH,IAAI,CAACI,EAAE,CAAC,UAACC,GAAuB;MAAA,OAAKA,GAAG,CAACC,GAAG,EAAE;IAAA;EAAC;AAAA,CAC5E,CAAC;;AAKHC,QAAQ,CAAC,kBAAkB,EAAE,YAAM;EACjCC,EAAE,CAAC,iCAAiC,6DAAE;IAAA;IAAA;MAAA;QAAA;UAC9BC,YAAY,GAAGT,IAAI,CAACI,EAAE,EAAE;UACxBM,SAAS,GAAGV,IAAI,CAACI,EAAE,CAAC,UAAAO,KAAK;YAAA,OAAIC,OAAO,CAACC,OAAO,CAACF,KAAK,CAAC;UAAA,EAAC;UAEpDG,UAAU,GAAGd,IAAI,CAACI,EAAE,CAAC;YAAA,OAAO;cAChCW,WAAW,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ;YAC5C,CAAC;UAAA,CAAC,CAAC;UAEGC,OAAO,GAAG;YACdC,EAAE,EAAEP,SAAS;YACbJ,GAAG,EAAEQ;UACP,CAAC;UAED,IAAAI,oCAAe,EACb,gCAAC,kCAAgB;YAAC,GAAG,EAAEF;UAAQ,GAC7B,gCAAC,gCAAe;YACd,MAAM,EAAE;cACNG,SAAS,EAAE,mBAAmB;cAC9BC,IAAI,EAAE,UAAU;cAChBC,KAAK,EAAE,UAAU;cACjBC,KAAK,EAAE;gBACLF,IAAI,EAAE,mBAAmB;gBACzBL,WAAW,EAAE,CAAC,aAAa,EAAE,eAAe,CAAC;gBAC7CQ,YAAY,EAAE,YAAY;gBAC1BC,iBAAiB,EAAE,mBAAmB;gBACtCC,IAAI,EAAE;cACR,CAAC;cACDC,KAAK,EAAE,WAAW;cAClBC,SAAS,EAAE;gBAAEC,IAAI,EAAE;cAAe;YACpC,CAAE;YACF,QAAQ,EAAEnB;UAAa,EACvB,EACF,gCAAC,gCAAe;YACd,MAAM,EAAE;cACNW,IAAI,EAAE,OAAO;cACbC,KAAK,EAAE,OAAO;cACdQ,kBAAkB,EAAE,CAAC,UAAU,CAAC;cAChCP,KAAK,EAAE;gBACLF,IAAI,EAAE,gBAAgB;gBACtBU,WAAW,EAAE,IAAI;gBACjBP,YAAY,EAAE,YAAY;gBAC1BC,iBAAiB,EAAE,gBAAgB;gBACnCC,IAAI,EAAE;cACR,CAAC;cACDC,KAAK,EAAE,WAAW;cAClBC,SAAS,EAAE;gBAAEC,IAAI,EAAE;cAAe;YACpC,CAAE;YACF,QAAQ,EAAEnB;UAAa,EACvB,CACe,CACpB;UAEDsB,iBAAS,CAACC,KAAK,CAACC,cAAM,CAACC,SAAS,CAAC,eAAe,CAAC,CAAC;UAAA;UAAA,OAE5CD,cAAM,CAACE,UAAU,CAAC,QAAQ,CAAC;QAAA;UAEjCC,MAAM,CAACjC,gCAA2B,CAAC,CAACkC,qBAAqB,CAAC,CAAC,CAAC;UAC5DD,MAAM,CAACjC,gCAA2B,CAAC,CAACmC,wBAAwB,CAC1D;YAAErB,EAAE,EAAEP,SAAS;YAAEJ,GAAG,EAAEQ;UAAW,CAAC,EAClC;YACEyB,UAAU,EAAE,gBAAgB;YAC5BC,OAAO,EAAE;cACP,mBAAmB,EAAE;YACvB,CAAC;YACDC,UAAU,EAAE,WAAW;YACvBC,IAAI,EAAE,EAAE;YACRC,SAAS,EAAE;UACb,CAAC,CACF;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA,CACF,GAAC;AACJ,CAAC,CAAC"}