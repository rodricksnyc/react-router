{"version":3,"file":"TreeSelectPopup.js","names":["TreeSelectPopup","anchorElement","isOpen","setOpen","children","React","useState","popupStyle","setPopupStyle","useEffect","onResize","debounce","getPopupStyle","window","addEventListener","removeEventListener","usePopover","content","focusTrap","triggerElement","triggerToggle","popover","anchor","rect","getBoundingClientRect","minWidth","width","left","top","height"],"sources":["../../../src/TreeSelect/TreeSelectPopup.tsx"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\nimport { PopoverContent, usePopover } from '@looker/components'\nimport debounce from 'lodash/debounce'\nimport React from 'react'\n\ntype TreePopupProps = React.PropsWithChildren<{\n  anchorElement: HTMLElement | null\n  isOpen: boolean\n  setOpen: (value: boolean) => void\n}>\n\ninterface PopupStyle {\n  minWidth?: string\n  left?: string\n  top?: string\n}\n\nexport const TreeSelectPopup = ({\n  anchorElement,\n  isOpen,\n  setOpen,\n  children,\n}: TreePopupProps) => {\n  const [popupStyle, setPopupStyle] = React.useState<PopupStyle>()\n\n  React.useEffect(() => {\n    const onResize = debounce(() => {\n      setPopupStyle(getPopupStyle(anchorElement))\n    }, 200)\n    window.addEventListener('resize', onResize)\n    setPopupStyle(getPopupStyle(anchorElement))\n    return () => {\n      window.removeEventListener('resize', onResize)\n    }\n  }, [anchorElement])\n\n  const { popover } = usePopover({\n    content: <PopoverContent style={popupStyle}>{children}</PopoverContent>,\n    focusTrap: false,\n    isOpen,\n    setOpen,\n    triggerElement: anchorElement,\n    triggerToggle: false,\n  })\n\n  return popover || null\n}\n\nconst getPopupStyle = (anchor: HTMLElement | null) => {\n  if (!anchor) return {}\n  // getBoundingClientRect used only once per user interaction\n  // and won't affect performance badly.\n  //\n  // getBoundingClientRect required to properly position\n  // popup below anchor input. Other css solution\n  // (where popup lives withing the same container\n  // with anchor input) will still require getBoundingClientRect\n  // to make sure popup won't go out of window size.\n  const rect = anchor.getBoundingClientRect()\n  return {\n    minWidth: rect.width + 'px',\n    left: rect.left + 'px',\n    top: rect.top + rect.height + 'px',\n  }\n}\n"],"mappings":";;;;;;;;AAIA;AACA;AACA;;AAcO,IAAMA,eAAe,GAAG,SAAlBA,eAAe,OAKN;EAAA,IAJpBC,aAAa,QAAbA,aAAa;IACbC,MAAM,QAANA,MAAM;IACNC,OAAO,QAAPA,OAAO;IACPC,QAAQ,QAARA,QAAQ;EAER,sBAAoCC,iBAAK,CAACC,QAAQ,EAAc;IAAA;IAAzDC,UAAU;IAAEC,aAAa;EAEhCH,iBAAK,CAACI,SAAS,CAAC,YAAM;IACpB,IAAMC,QAAQ,GAAG,IAAAC,oBAAQ,EAAC,YAAM;MAC9BH,aAAa,CAACI,aAAa,CAACX,aAAa,CAAC,CAAC;IAC7C,CAAC,EAAE,GAAG,CAAC;IACPY,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAEJ,QAAQ,CAAC;IAC3CF,aAAa,CAACI,aAAa,CAACX,aAAa,CAAC,CAAC;IAC3C,OAAO,YAAM;MACXY,MAAM,CAACE,mBAAmB,CAAC,QAAQ,EAAEL,QAAQ,CAAC;IAChD,CAAC;EACH,CAAC,EAAE,CAACT,aAAa,CAAC,CAAC;EAEnB,kBAAoB,IAAAe,sBAAU,EAAC;MAC7BC,OAAO,EAAE,gCAAC,0BAAc;QAAC,KAAK,EAAEV;MAAW,GAAEH,QAAQ,CAAkB;MACvEc,SAAS,EAAE,KAAK;MAChBhB,MAAM,EAANA,MAAM;MACNC,OAAO,EAAPA,OAAO;MACPgB,cAAc,EAAElB,aAAa;MAC7BmB,aAAa,EAAE;IACjB,CAAC,CAAC;IAPMC,OAAO,eAAPA,OAAO;EASf,OAAOA,OAAO,IAAI,IAAI;AACxB,CAAC;AAAA;AAED,IAAMT,aAAa,GAAG,SAAhBA,aAAa,CAAIU,MAA0B,EAAK;EACpD,IAAI,CAACA,MAAM,EAAE,OAAO,CAAC,CAAC;EAStB,IAAMC,IAAI,GAAGD,MAAM,CAACE,qBAAqB,EAAE;EAC3C,OAAO;IACLC,QAAQ,EAAEF,IAAI,CAACG,KAAK,GAAG,IAAI;IAC3BC,IAAI,EAAEJ,IAAI,CAACI,IAAI,GAAG,IAAI;IACtBC,GAAG,EAAEL,IAAI,CAACK,GAAG,GAAGL,IAAI,CAACM,MAAM,GAAG;EAChC,CAAC;AACH,CAAC"}