{"version":3,"file":"FilterCollection.spec.js","names":["React","renderWithTheme","fireEvent","screen","FilterCollection","DashboardFilter","jest","mock","requireActual","model_fieldname_suggestions","fn","sdk","get","describe","it","onChangeMock","sdkOkMock","value","Promise","resolve","sdkGetMock","suggestions","sdkMock","ok","dimension","name","title","field","project_name","suggest_dimension","view","model","ui_config","type","listens_to_filters","suggestable","click","getByText","findByText","expect","toHaveBeenCalledTimes","toHaveBeenLastCalledWith","field_name","filters","model_name","term","view_name"],"sources":["../../../src/FilterCollection/FilterCollection.spec.tsx"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nimport React from 'react'\nimport { renderWithTheme } from '@looker/components-test-utils'\nimport type { IAPIMethods } from '@looker/sdk-rtl'\nimport { fireEvent, screen } from '@testing-library/react'\nimport { FilterCollection } from './FilterCollection'\nimport { DashboardFilter } from '../DashboardFilter'\n\njest.mock('@looker/sdk', () => ({\n  ...jest.requireActual('@looker/sdk'),\n  model_fieldname_suggestions: jest.fn((sdk: { get: () => any }) => sdk.get()),\n}))\n\n// eslint-disable-next-line import/first\nimport { model_fieldname_suggestions } from '@looker/sdk'\n\ndescribe('FilterCollection', () => {\n  it('shares state for linked filters', async () => {\n    const onChangeMock = jest.fn()\n    const sdkOkMock = jest.fn(value => Promise.resolve(value))\n\n    const sdkGetMock = jest.fn(() => ({\n      suggestions: ['brand1', 'brand2', 'brand3'],\n    }))\n\n    const sdkMock = {\n      ok: sdkOkMock,\n      get: sdkGetMock,\n    } as unknown as IAPIMethods\n\n    renderWithTheme(\n      <FilterCollection sdk={sdkMock}>\n        <DashboardFilter\n          filter={{\n            dimension: 'products.category',\n            name: 'Category',\n            title: 'Category',\n            field: {\n              name: 'products.category',\n              suggestions: ['Accessories', 'Home + Garden'],\n              project_name: 'testmodel_',\n              suggest_dimension: 'products.category',\n              view: 'products',\n            },\n            model: 'testmodel',\n            ui_config: { type: 'button_group' },\n          }}\n          onChange={onChangeMock}\n        />\n        <DashboardFilter\n          filter={{\n            name: 'Brand',\n            title: 'Brand',\n            listens_to_filters: ['Category'],\n            field: {\n              name: 'products.brand',\n              suggestable: true,\n              project_name: 'testmodel_',\n              suggest_dimension: 'products.brand',\n              view: 'products',\n            },\n            model: 'testmodel',\n            ui_config: { type: 'button_group' },\n          }}\n          onChange={onChangeMock}\n        />\n      </FilterCollection>\n    )\n\n    fireEvent.click(screen.getByText('Home + Garden'))\n\n    await screen.findByText('brand1')\n\n    expect(model_fieldname_suggestions).toHaveBeenCalledTimes(2)\n    expect(model_fieldname_suggestions).toHaveBeenLastCalledWith(\n      { ok: sdkOkMock, get: sdkGetMock },\n      {\n        field_name: 'products.brand',\n        filters: {\n          'products.category': 'Home%20%2B%20Garden',\n        },\n        model_name: 'testmodel',\n        term: '',\n        view_name: 'products',\n      }\n    )\n  })\n})\n"],"mappings":";;;;AAKA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,eAAe,QAAQ,+BAA+B;AAE/D,SAASC,SAAS,EAAEC,MAAM,QAAQ,wBAAwB;AAC1D,SAASC,gBAAgB,QAAQ,oBAAoB;AACrD,SAASC,eAAe,QAAQ,oBAAoB;AAEpDC,IAAI,CAACC,IAAI,CAAC,aAAa,EAAE,sCACpBD,IAAI,CAACE,aAAa,CAAC,aAAa,CAAC;EACpCC,2BAA2B,EAAEH,IAAI,CAACI,EAAE,CAAEC,GAAuB,IAAKA,GAAG,CAACC,GAAG,EAAE;AAAC,EAC5E,CAAC;;AAGH,SAASH,2BAA2B,QAAQ,aAAa;AAEzDI,QAAQ,CAAC,kBAAkB,EAAE,MAAM;EACjCC,EAAE,CAAC,iCAAiC,EAAE,YAAY;IAChD,MAAMC,YAAY,GAAGT,IAAI,CAACI,EAAE,EAAE;IAC9B,MAAMM,SAAS,GAAGV,IAAI,CAACI,EAAE,CAACO,KAAK,IAAIC,OAAO,CAACC,OAAO,CAACF,KAAK,CAAC,CAAC;IAE1D,MAAMG,UAAU,GAAGd,IAAI,CAACI,EAAE,CAAC,OAAO;MAChCW,WAAW,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ;IAC5C,CAAC,CAAC,CAAC;IAEH,MAAMC,OAAO,GAAG;MACdC,EAAE,EAAEP,SAAS;MACbJ,GAAG,EAAEQ;IACP,CAA2B;IAE3BnB,eAAe,CACb,oBAAC,gBAAgB;MAAC,GAAG,EAAEqB;IAAQ,GAC7B,oBAAC,eAAe;MACd,MAAM,EAAE;QACNE,SAAS,EAAE,mBAAmB;QAC9BC,IAAI,EAAE,UAAU;QAChBC,KAAK,EAAE,UAAU;QACjBC,KAAK,EAAE;UACLF,IAAI,EAAE,mBAAmB;UACzBJ,WAAW,EAAE,CAAC,aAAa,EAAE,eAAe,CAAC;UAC7CO,YAAY,EAAE,YAAY;UAC1BC,iBAAiB,EAAE,mBAAmB;UACtCC,IAAI,EAAE;QACR,CAAC;QACDC,KAAK,EAAE,WAAW;QAClBC,SAAS,EAAE;UAAEC,IAAI,EAAE;QAAe;MACpC,CAAE;MACF,QAAQ,EAAElB;IAAa,EACvB,EACF,oBAAC,eAAe;MACd,MAAM,EAAE;QACNU,IAAI,EAAE,OAAO;QACbC,KAAK,EAAE,OAAO;QACdQ,kBAAkB,EAAE,CAAC,UAAU,CAAC;QAChCP,KAAK,EAAE;UACLF,IAAI,EAAE,gBAAgB;UACtBU,WAAW,EAAE,IAAI;UACjBP,YAAY,EAAE,YAAY;UAC1BC,iBAAiB,EAAE,gBAAgB;UACnCC,IAAI,EAAE;QACR,CAAC;QACDC,KAAK,EAAE,WAAW;QAClBC,SAAS,EAAE;UAAEC,IAAI,EAAE;QAAe;MACpC,CAAE;MACF,QAAQ,EAAElB;IAAa,EACvB,CACe,CACpB;IAEDb,SAAS,CAACkC,KAAK,CAACjC,MAAM,CAACkC,SAAS,CAAC,eAAe,CAAC,CAAC;IAElD,MAAMlC,MAAM,CAACmC,UAAU,CAAC,QAAQ,CAAC;IAEjCC,MAAM,CAAC9B,2BAA2B,CAAC,CAAC+B,qBAAqB,CAAC,CAAC,CAAC;IAC5DD,MAAM,CAAC9B,2BAA2B,CAAC,CAACgC,wBAAwB,CAC1D;MAAElB,EAAE,EAAEP,SAAS;MAAEJ,GAAG,EAAEQ;IAAW,CAAC,EAClC;MACEsB,UAAU,EAAE,gBAAgB;MAC5BC,OAAO,EAAE;QACP,mBAAmB,EAAE;MACvB,CAAC;MACDC,UAAU,EAAE,WAAW;MACvBC,IAAI,EAAE,EAAE;MACRC,SAAS,EAAE;IACb,CAAC,CACF;EACH,CAAC,CAAC;AACJ,CAAC,CAAC"}