{"version":3,"file":"seriesPointStyle.js","names":["seriesPointStyle","config","data","fields","type","_point_style","point_style","series","restConfig","POINT_STYLE","circle","circle_outline","filled","outline","none","normalizedPointStyle","measures","getMeasureNames","buildArraySeries","s","arraySeries","i","length","style","set","buildNamedSeries","namedSeries","field","get","Array","isArray"],"sources":["../../../src/configTransformations/seriesPointStyle.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nimport get from 'lodash/get'\nimport set from 'lodash/set'\nimport type { CArea, CLine, CLineSeries } from '../adapters'\nimport type { ConfigHelper, RawApiConfigResponse } from '../types'\nimport { getMeasureNames } from '../utils'\n\n/**\n * Populate point style from raw api response.\n * Multiple point styles are not supported by the api. Sets all series\n * to match point_style when it's not othrewise set. Works for both array and\n * named series objects.\n */\nexport const seriesPointStyle: ConfigHelper<CLine | CArea> = ({\n  config,\n  data,\n  fields,\n}) => {\n  const { type, point_style: _point_style, series = {}, ...restConfig } = config\n\n  type PointStyleValues = CLineSeries['style']\n  type AllKeys = RawApiConfigResponse['point_style'] & PointStyleValues & ''\n\n  const POINT_STYLE: Record<AllKeys, PointStyleValues> = {\n    '': 'filled',\n    circle: 'filled',\n    circle_outline: 'outline',\n    filled: 'filled',\n    outline: 'outline',\n    // scatter plots can't have point style set to \"none\"\n    ...(type !== 'scatter' ? { none: 'none' } : { none: 'filled' }),\n  }\n\n  const normalizedPointStyle =\n    POINT_STYLE[(config.point_style || '') as AllKeys]\n\n  const measures = getMeasureNames(fields)\n\n  const buildArraySeries = (s: CLineSeries[] = []) => {\n    const arraySeries = [...s]\n    for (let i = 0; i < measures.length; i++) {\n      const { style = normalizedPointStyle } = arraySeries[i] || {}\n      set(arraySeries, [i, 'style'], style)\n    }\n    return arraySeries\n  }\n\n  const buildNamedSeries = (s: { [k: string]: CLineSeries }) => {\n    const namedSeries = { ...s }\n    for (const field of measures) {\n      const style = get(namedSeries, [field, 'style'], normalizedPointStyle)\n      set(namedSeries, [field, 'style'], style)\n    }\n    return namedSeries\n  }\n\n  return {\n    config: {\n      series: Array.isArray(series)\n        ? buildArraySeries(series)\n        : buildNamedSeries(series),\n      type,\n      ...restConfig,\n    },\n    data,\n    fields,\n  }\n}\n"],"mappings":";;;;;;;;;;AAKA;AACA;AAGA;AAA0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAQnC,IAAMA,gBAA6C,GAAG,SAAhDA,gBAA6C,OAIpD;EAAA,IAHJC,MAAM,QAANA,MAAM;IACNC,IAAI,QAAJA,IAAI;IACJC,MAAM,QAANA,MAAM;EAEN,IAAQC,IAAI,GAA4DH,MAAM,CAAtEG,IAAI;IAAeC,YAAY,GAAiCJ,MAAM,CAAhEK,WAAW;IAAA,iBAA+CL,MAAM,CAArCM,MAAM;IAANA,MAAM,+BAAG,CAAC,CAAC;IAAKC,UAAU,6CAAKP,MAAM;EAK9E,IAAMQ,WAA8C;IAClD,EAAE,EAAE,QAAQ;IACZC,MAAM,EAAE,QAAQ;IAChBC,cAAc,EAAE,SAAS;IACzBC,MAAM,EAAE,QAAQ;IAChBC,OAAO,EAAE;EAAS,GAEdT,IAAI,KAAK,SAAS,GAAG;IAAEU,IAAI,EAAE;EAAO,CAAC,GAAG;IAAEA,IAAI,EAAE;EAAS,CAAC,CAC/D;EAED,IAAMC,oBAAoB,GACxBN,WAAW,CAAER,MAAM,CAACK,WAAW,IAAI,EAAE,CAAa;EAEpD,IAAMU,QAAQ,GAAG,IAAAC,sBAAe,EAACd,MAAM,CAAC;EAExC,IAAMe,gBAAgB,GAAG,SAAnBA,gBAAgB,GAA8B;IAAA,IAA1BC,CAAgB,uEAAG,EAAE;IAC7C,IAAMC,WAAW,uCAAOD,CAAC,CAAC;IAC1B,KAAK,IAAIE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,QAAQ,CAACM,MAAM,EAAED,CAAC,EAAE,EAAE;MACxC,YAAyCD,WAAW,CAACC,CAAC,CAAC,IAAI,CAAC,CAAC;QAAA,qBAArDE,KAAK;QAALA,KAAK,6BAAGR,oBAAoB;MACpC,IAAAS,eAAG,EAACJ,WAAW,EAAE,CAACC,CAAC,EAAE,OAAO,CAAC,EAAEE,KAAK,CAAC;IACvC;IACA,OAAOH,WAAW;EACpB,CAAC;EAED,IAAMK,gBAAgB,GAAG,SAAnBA,gBAAgB,CAAIN,CAA+B,EAAK;IAC5D,IAAMO,WAAW,qBAAQP,CAAC,CAAE;IAAA,2CACRH,QAAQ;MAAA;IAAA;MAA5B,oDAA8B;QAAA,IAAnBW,KAAK;QACd,IAAMJ,KAAK,GAAG,IAAAK,eAAG,EAACF,WAAW,EAAE,CAACC,KAAK,EAAE,OAAO,CAAC,EAAEZ,oBAAoB,CAAC;QACtE,IAAAS,eAAG,EAACE,WAAW,EAAE,CAACC,KAAK,EAAE,OAAO,CAAC,EAAEJ,KAAK,CAAC;MAC3C;IAAC;MAAA;IAAA;MAAA;IAAA;IACD,OAAOG,WAAW;EACpB,CAAC;EAED,OAAO;IACLzB,MAAM;MACJM,MAAM,EAAEsB,KAAK,CAACC,OAAO,CAACvB,MAAM,CAAC,GACzBW,gBAAgB,CAACX,MAAM,CAAC,GACxBkB,gBAAgB,CAAClB,MAAM,CAAC;MAC5BH,IAAI,EAAJA;IAAI,GACDI,UAAU,CACd;IACDN,IAAI,EAAJA,IAAI;IACJC,MAAM,EAANA;EACF,CAAC;AACH,CAAC;AAAA"}