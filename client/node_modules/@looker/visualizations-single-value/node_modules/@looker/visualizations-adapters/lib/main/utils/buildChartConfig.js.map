{"version":3,"file":"buildChartConfig.js","names":["buildChartConfig","args","isDataValid","data","length","fields","measures","flow","normalizeChartTypes","type","config","configTransformations","chartConfigByType","sanitizeSDKResponse"],"sources":["../../../src/utils/buildChartConfig.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\nimport {\n  normalizeChartTypes,\n  chartConfigByType,\n  sanitizeSDKResponse,\n} from '../configTransformations'\nimport flow from 'lodash/flow'\nimport type {\n  ConfigHelperArgs,\n  CAll,\n  RawApiConfigResponse,\n  Fields,\n  SDKRecord,\n  SupportedChartTypes,\n} from '../types'\n\ntype ChartConfigArgs = {\n  config: Partial<CAll> | Partial<RawApiConfigResponse>\n  data?: SDKRecord[]\n  fields?: Fields\n}\n\n/**\n * Utility function builds and sanitizes the public config object from\n * the provided raw sdk response and selected transformations.\n * @param config vis config as it comes unsanitized from sdk\n * @param data query response\n * @param fields metadata describing fields and dimensions from query\n * @returns\n */\nexport const buildChartConfig = (args: ChartConfigArgs) => {\n  const isDataValid = args.data?.length && args.fields?.measures?.length\n\n  const { config } = flow([\n    normalizeChartTypes,\n    (args: ConfigHelperArgs<CAll>) => {\n      const { type } = args.config\n\n      const configTransformations =\n        chartConfigByType[type as keyof SupportedChartTypes] ||\n        chartConfigByType.default\n\n      if (isDataValid) {\n        // if necessary data is present, run transformations\n        return flow(configTransformations)(args)\n      } else {\n        // if no data or fields, simply pass through unmodified results at this point\n        return args\n      }\n    },\n    sanitizeSDKResponse,\n  ])(args)\n\n  return config\n}\n"],"mappings":";;;;;;;AAIA;AAKA;;AAwBO,IAAMA,gBAAgB,GAAG,SAAnBA,gBAAgB,CAAIC,IAAqB,EAAK;EAAA;EACzD,IAAMC,WAAW,GAAG,eAAAD,IAAI,CAACE,IAAI,+CAAT,WAAWC,MAAM,sBAAIH,IAAI,CAACI,MAAM,0EAAX,aAAaC,QAAQ,0DAArB,sBAAuBF,MAAM;EAEtE,YAAmB,IAAAG,iBAAI,EAAC,CACtBC,0CAAmB,EACnB,UAACP,IAA4B,EAAK;MAChC,IAAQQ,IAAI,GAAKR,IAAI,CAACS,MAAM,CAApBD,IAAI;MAEZ,IAAME,qBAAqB,GACzBC,wCAAiB,CAACH,IAAI,CAA8B,IACpDG,wCAAiB,WAAQ;MAE3B,IAAIV,WAAW,EAAE;QAEf,OAAO,IAAAK,iBAAI,EAACI,qBAAqB,CAAC,CAACV,IAAI,CAAC;MAC1C,CAAC,MAAM;QAEL,OAAOA,IAAI;MACb;IACF,CAAC,EACDY,0CAAmB,CACpB,CAAC,CAACZ,IAAI,CAAC;IAlBAS,MAAM,SAANA,MAAM;EAoBd,OAAOA,MAAM;AACf,CAAC;AAAA"}